
# Scout mini SLAM + Nav2 튜토리얼

## ✅ Scout mini 브링업

### [파이] 환경 설정
```
# ssh 접속
# 로컬 PC와 라즈베리파이가 같은 LAN에 있어야 함
ssh eddy@192.168.123.250

# ros2 환경설정
source ~/ros2_ws/install/setup.bash

# 빌드 및 실행
cd ~/ros2_ws
colcon build
source install/setup.bash
ros2 launch scout_base scout_base.launch.py

# can통신 확인
ip link show can0
```

### [로컬pc] 환경 설정
```
# ros2 환경 설정
source ~/ros2_ws/install/setup.bash

# 라즈베리파이와 통신할 수 있도록 ROS_DOMAIN_ID와 DDS 설정 맞추기
# 라즈베리파이에서도 동일하게 설정
# 라즈베리파이 IP를 ROS2에 알리기 (옵션, 일부 DDS에서는 필요)

export RPLIDAR_MODEL=A1
export ROS_DOMAIN_ID=30
export ROS_LOCALHOST_ONLY=0
export RMW_IMPLEMENTATION=rmw_fastrtps_cpp # rmw_cyclonedds_cpp
source /opt/ros/humble/setup.bash
source ~/ros2_ws/install/setup.bash

```

### Rviz 환경설정
<img width="913" height="783" alt="image" src="https://github.com/user-attachments/assets/42af1e03-754e-4d7a-a0f4-0f95a74a8ec5" />


## nav2 실행

```bash
# 시뮬레이션
ros2 launch scout_navigation nav2.launch.py \
      namespace:=scout_mini \
      map_name:=/home/eddy/ros2_ws/maps/slamdunk.yaml \
      use_rviz:=false

# 실제 로봇
ros2 launch scout_navigation nav2.launch.py \
      use_sim_time:=False \
      map_name:=/home/eddy/ros2_ws/maps/slamdunk.yaml \
      nav2_params_file:=/home/eddy/ros2_ws/src/scout_navigation/config/nav2_params.yaml \
      use_rviz:=false

# chat-gpt
ros2 launch nav2_bringup bringup_launch.py \
    map:=/home/eddy/ros2_ws/maps/slamdunk.yaml \
    autostart:=true \
    use_sim_time:=false

```

## ✅ Scout mini - Navigation2 실행 순서

**0. can 통신 : [참고](https://github.com/agilexrobotics/scout_ros2)**
```
ifconfig can0
# 활성화
sudo ip link set can0 up type can bitrate 500000
sudo ip link set up can0
```

**1. ssh / 로컬 우분투에서 nav2 실행 : [참고](https://github.com/mattiadutto/scout_navigation)**

      - slam으로 이미 맵.yaml이 저장한 상태
      - nav2 실행시에는 slam 실행 x

| 순서 | 실행 위치 | 명령어                                                                   | 설명            |
| -- | ----- | --------------------------------------------------------------------- | ------------- |
| 1  | Local | `ros2 launch scout_description scout_base_description.launch.py`      | 로봇 모델 표시      |
| 2  | SSH   | `ros2 launch rplidar_ros rplidar_a1_launch.py`                           | 라이다 실행        |
| 3  | SSH   | `ros2 launch scout_base scout_base.launch.py`                    | 로봇 bringup 실행 |
| 3  | SSH   | `ros2 launch slam_toolbox online_async_launch.py` | SLAM 수행       |
| 4  | SSH   | `ros2 run nav2_map_server map_saver_cli -f slamdunk`| 맵 저장          |
| 6  | SSH   | `ros2 launch nav2_bringup bringup_launch.py map:=/home/eddy/ros2_ws/maps/slamdunk.yaml autostart:=true use_sim_time:=false`                   | Nav2 실행(저장된 맵 불러오기)  |
| 7  | Local | `ros2 run rviz2 rviz2`                                                | 자율주행 시각화      |

<br>


**참고**
- 라즈베리파이(ssh)에서 파일 로컬로 내려받기 명령어
```
scp pi@192.168.123.250:/home/eddy/ros2_ws/maps/slamdunk.pgm ~/ros2_ws/maps/
```

### ✅ 라즈베리파이 웹캠 연결 및 실행

#### [파이]

```
ros2 run v4l2_camera v4l2_camera_node \ --ros-args \ -p video_device:="/dev/video0" \ -p image_size:="[640,480]" \ -p pixel_format:="YUYV" \ -p frame_rate:=30 \ -p image_transport:=compressed
```

#### [로컬]
```
sudo apt install ros-humble-rqt-image-view  설치
rqt_image_view

# ~/.bashrc에 추가
export PATH=$PATH:/opt/ros/humble/lib/rqt_image_view
```


---

